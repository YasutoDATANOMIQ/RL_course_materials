import numpy as np
import matplotlib.pyplot as plt
import gym

from basic_MDP.environment import GridMapEnvironment
from model_free_RL.tabular_model_free_agent import QLearningAgent
from model_free_RL.tabular_model_free_agent import DoubleQLearningAgent
from model_free_RL.tabular_model_free_agent import repetive_experiment
from model_free_RL.tabular_model_free_agent import compare_experiments

if __name__ == '__main__':
    block = np.nan
    grid = np.array([[0,     0,    0, 0, 0, 0],
                     [0, block, 1, 0, 0, 0],
                     [0, block, block, -1, 0, 0],
                     [0, -1, 0, 0, 0, 0],
                     [0, 0, 0, 0, 0, 0]
                     ])

    # Setting up an enviornment
    grid_map_env = GridMapEnvironment(grid)

    # Setting up agents to compare
    ql_agent = QLearningAgent(grid_map_env, epsilon=0.25)
    double_ql_agent = DoubleQLearningAgent(grid_map_env, epsilon=0.25)
    el_agent_list = [ql_agent, double_ql_agent]
    legend_label_list = ['Q-Learning', 'Double Q-Learning']

    # Conducting experiments with different agents.
    episode_count = 500
    experiment_num = 100
    compare_experiments(el_agent_list, legend_label_list, experiment_num, episode_count, grid_map_env)

